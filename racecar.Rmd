---
title: "R Notebook"
output: html_notebook
---



```{r}
f1<-read.csv('f1_data.csv')
head(f1)
```

```{r}
library(ggplot2)

library(dplyr)

formula_1_data<-f1 %>% filter(qual_gap>=0)

test<-formula_1_data %>% group_by(CIRCUITREF) %>% 
  summarise(total_races=n()) %>% 
  filter(total_races > 29)

circuits<-test$CIRCUITREF

formula_1_data_filtered<-formula_1_data %>% filter(CIRCUITREF %in% circuits) %>% filter(grid < 4)



#######
formula_1_data_filtered$grid<-as.factor(formula_1_data_filtered$grid)
plot_circuits<-ggplot(formula_1_data_filtered,aes(x=grid,y=won_race, fill=grid)) +
  geom_bar(stat="identity") + facet_wrap(~CIRCUITREF) + theme_minimal()

plot_circuits



######
plot_wins_position<-ggplot(formula_1_data_filtered,aes(x=grid,y=won_race, fill=grid))+
  geom_bar(stat = "identity")+ labs(title = "All time wins by starting position",
                                    x="Starting Position",
                                    y="Total Wins") + theme_minimal()

plot_wins_position

#####
formula_1_data_filtered$grid<-as.factor(formula_1_data_filtered$grid)

plot_quality2<-ggplot(formula_1_data_filtered, aes(x=qual_gap, y=finish_position, color=grid))+geom_point()+theme_minimal()
 
plot_quality2

#####

                                                            
```


